#ifndef CONVERSIONHANDLER_H
#define CONVERSIONHANDLER_H
#include <QObject>
#include <QJsonObject>
#include <QJsonDocument>
#include <QJsonArray>
#include <QFile>
#include "library.h"


enum conversionErrors
{
    PLAYLIST_NOT_FOUND_ERROR = 0,
};

class ConversionHandler : public QObject
{
    Q_OBJECT
    private:
        const Library& library;
        std::unordered_map<QString,QString> MIMEhash = {  {"audio/3gpp", "*3gpp"},
                                                         {"video/jpm", "*jpm"},
                                                         {"audio/mp3", "*mp3"},
                                                         {"text/rtf", "*rtf"},
                                                         {"audio/wave", "*wav"},
                                                         {"text/xml", "*xml"},
                                                         {"video/3gpp2", "3g2"},
                                                         {"video/3gpp", "3gp"},
                                                         {"video/3gpp", "3gpp"},
                                                         {"application/pkix-attr-cert", "ac"},
                                                         {"audio/adpcm", "adp"},
                                                         {"application/postscript", "ai"},
                                                         {"image/apng", "apng"},
                                                         {"text/cache-manifest", "appcache"},
                                                         {"application/pgp-signature", "asc"},
                                                         {"application/atom+xml", "atom"},
                                                         {"application/atomcat+xml", "atomcat"},
                                                         {"application/atomsvc+xml", "atomsvc"},
                                                         {"audio/basic", "au"},
                                                         {"application/applixware", "aw"},
                                                         {"application/bdoc", "bdoc"},
                                                         {"application/octet-stream", "bin"},
                                                         {"image/bmp", "bmp"},
                                                         {"application/octet-stream", "bpk"},
                                                         {"application/octet-stream", "buffer"},
                                                         {"application/ccxml+xml", "ccxml"},
                                                         {"application/cdmi-capability", "cdmia"},
                                                         {"application/cdmi-container", "cdmic"},
                                                         {"application/cdmi-domain", "cdmid"},
                                                         {"application/cdmi-object", "cdmio"},
                                                         {"application/cdmi-queue", "cdmiq"},
                                                         {"application/pkix-cert", "cer"},
                                                         {"image/cgm", "cgm"},
                                                         {"application/java-vm", "class"},
                                                         {"text/coffeescript", "coffee"},
                                                         {"text/plain", "conf"},
                                                         {"application/mac-compactpro", "cpt"},
                                                         {"application/pkix-crl", "crl"},
                                                         {"text/css", "css"},
                                                         {"text/csv", "csv"},
                                                         {"application/cu-seeme", "cu"},
                                                         {"application/davmount+xml", "davmount"},
                                                         {"application/docbook+xml", "dbk"},
                                                         {"application/octet-stream", "deb"},
                                                         {"text/plain", "def"},
                                                         {"application/octet-stream", "deploy"},
                                                         {"message/disposition-notification", "disposition-notification"},
                                                         {"application/octet-stream", "dist"},
                                                         {"application/octet-stream", "distz"},
                                                         {"application/octet-stream", "dll"},
                                                         {"application/octet-stream", "dmg"},
                                                         {"application/octet-stream", "dms"},
                                                         {"application/msword", "doc"},
                                                         {"application/msword", "dot"},
                                                         {"image/dicom-rle", "drle"},
                                                         {"application/dssc+der", "dssc"},
                                                         {"application/xml-dtd", "dtd"},
                                                         {"application/octet-stream", "dump"},
                                                         {"application/java-archive", "ear"},
                                                         {"application/ecmascript", "ecma"},
                                                         {"application/octet-stream", "elc"},
                                                         {"image/emf", "emf"},
                                                         {"message/rfc822", "eml"},
                                                         {"application/emma+xml", "emma"},
                                                         {"application/postscript", "eps"},
                                                         {"application/epub+zip", "epub"},
                                                         {"application/ecmascript", "es"},
                                                         {"application/octet-stream", "exe"},
                                                         {"application/exi", "exi"},
                                                         {"image/aces", "exr"},
                                                         {"application/andrew-inset", "ez"},
                                                         {"image/fits", "fits"},
                                                         {"audio/flac", "flac"},
                                                         {"image/g3fax", "g3"},
                                                         {"application/rpki-ghostbusters", "gbr"},
                                                         {"application/geo+json", "geojson"},
                                                         {"image/gif", "gif"},
                                                         {"model/gltf-binary", "glb"},
                                                         {"model/gltf+json", "gltf"},
                                                         {"application/gml+xml", "gml"},
                                                         {"application/gpx+xml", "gpx"},
                                                         {"application/srgs", "gram"},
                                                         {"application/srgs+xml", "grxml"},
                                                         {"application/gxf", "gxf"},
                                                         {"application/gzip", "gz"},
                                                         {"video/h261", "h261"},
                                                         {"video/h263", "h263"},
                                                         {"video/h264", "h264"},
                                                         {"image/heic", "heic"},
                                                         {"image/heic-sequence", "heics"},
                                                         {"image/heif", "heif"},
                                                         {"image/heif-sequence", "heifs"},
                                                         {"application/hjson", "hjson"},
                                                         {"application/winhlp", "hlp"},
                                                         {"application/mac-binhex40", "hqx"},
                                                         {"text/html", "htm"},
                                                         {"text/html", "html"},
                                                         {"text/calendar", "ics"},
                                                         {"image/ief", "ief"},
                                                         {"text/calendar", "ifb"},
                                                         {"model/iges", "iges"},
                                                         {"model/iges", "igs"},
                                                         {"application/octet-stream", "img"},
                                                         {"text/plain", "in"},
                                                         {"text/plain", "ini"},
                                                         {"application/inkml+xml", "ink"},
                                                         {"application/inkml+xml", "inkml"},
                                                         {"application/ipfix", "ipfix"},
                                                         {"application/octet-stream", "iso"},
                                                         {"text/jade", "jade"},
                                                         {"application/java-archive", "jar"},
                                                         {"image/jls", "jls"},
                                                         {"image/jp2", "jp2"},
                                                         {"image/jpeg", "jpe"},
                                                         {"image/jpeg", "jpeg"},
                                                         {"image/jpx", "jpf"},
                                                         {"image/jpeg", "jpg"},
                                                         {"image/jp2", "jpg2"},
                                                         {"video/jpm", "jpgm"},
                                                         {"video/jpeg", "jpgv"},
                                                         {"image/jpm", "jpm"},
                                                         {"image/jpx", "jpx"},
                                                         {"application/javascript", "js"},
                                                         {"application/json", "json"},
                                                         {"application/json5", "json5"},
                                                         {"application/ld+json", "jsonld"},
                                                         {"application/jsonml+json", "jsonml"},
                                                         {"text/jsx", "jsx"},
                                                         {"audio/midi", "kar"},
                                                         {"image/ktx", "ktx"},
                                                         {"text/less", "less"},
                                                         {"text/plain", "list"},
                                                         {"text/coffeescript", "litcoffee"},
                                                         {"text/plain", "log"},
                                                         {"application/lost+xml", "lostxml"},
                                                         {"application/octet-stream", "lrf"},
                                                         {"video/mpeg", "m1v"},
                                                         {"application/mp21", "m21"},
                                                         {"audio/mpeg", "m2a"},
                                                         {"video/mpeg", "m2v"},
                                                         {"audio/mpeg", "m3a"},
                                                         {"audio/mp4", "m4a"},
                                                         {"application/mp4", "m4p"},
                                                         {"application/mathematica", "ma"},
                                                         {"application/mads+xml", "mads"},
                                                         {"text/troff", "man"},
                                                         {"text/cache-manifest", "manifest"},
                                                         {"application/json", "map"},
                                                         {"application/octet-stream", "mar"},
                                                         {"text/markdown", "markdown"},
                                                         {"application/mathml+xml", "mathml"},
                                                         {"application/mathematica", "mb"},
                                                         {"application/mbox", "mbox"},
                                                         {"text/markdown", "md"},
                                                         {"text/troff", "me"},
                                                         {"model/mesh", "mesh"},
                                                         {"application/metalink4+xml", "meta4"},
                                                         {"application/metalink+xml", "metalink"},
                                                         {"application/mets+xml", "mets"},
                                                         {"application/rpki-manifest", "mft"},
                                                         {"audio/midi", "mid"},
                                                         {"audio/midi", "midi"},
                                                         {"message/rfc822", "mime"},
                                                         {"video/mj2", "mj2"},
                                                         {"video/mj2", "mjp2"},
                                                         {"application/javascript", "mjs"},
                                                         {"text/mathml", "mml"},
                                                         {"application/mods+xml", "mods"},
                                                         {"video/quicktime", "mov"},
                                                         {"audio/mpeg", "mp2"},
                                                         {"application/mp21", "mp21"},
                                                         {"audio/mpeg", "mp2a"},
                                                         {"audio/mpeg3", "mp3"},
                                                         {"video/mp4", "mp4"},
                                                         {"audio/mp4", "mp4a"},
                                                         {"application/mp4", "mp4s"},
                                                         {"video/mp4", "mp4v"},
                                                         {"application/dash+xml", "mpd"},
                                                         {"video/mpeg", "mpe"},
                                                         {"video/mpeg", "mpeg"},
                                                         {"video/mpeg", "mpg"},
                                                         {"video/mp4", "mpg4"},
                                                         {"audio/mpeg", "mpga"},
                                                         {"application/marc", "mrc"},
                                                         {"application/marcxml+xml", "mrcx"},
                                                         {"text/troff", "ms"},
                                                         {"application/mediaservercontrol+xml", "mscml"},
                                                         {"model/mesh", "msh"},
                                                         {"application/octet-stream", "msi"},
                                                         {"application/octet-stream", "msm"},
                                                         {"application/octet-stream", "msp"},
                                                         {"application/mxf", "mxf"},
                                                         {"application/xv+xml", "mxml"},
                                                         {"text/n3", "n3"},
                                                         {"application/mathematica", "nb"},
                                                         {"application/oda", "oda"},
                                                         {"audio/ogg", "oga"},
                                                         {"audio/ogg", "ogg"},
                                                         {"video/ogg", "ogv"},
                                                         {"application/ogg", "ogx"},
                                                         {"application/omdoc+xml", "omdoc"},
                                                         {"application/onenote", "onepkg"},
                                                         {"application/onenote", "onetmp"},
                                                         {"application/onenote", "onetoc"},
                                                         {"application/onenote", "onetoc2"},
                                                         {"application/oebps-package+xml", "opf"},
                                                         {"font/otf", "otf"},
                                                         {"application/rdf+xml", "owl"},
                                                         {"application/oxps", "oxps"},
                                                         {"application/pkcs10", "p10"},
                                                         {"application/pkcs7-mime", "p7c"},
                                                         {"application/pkcs7-mime", "p7m"},
                                                         {"application/pkcs7-signature", "p7s"},
                                                         {"application/pkcs8", "p8"},
                                                         {"application/pdf", "pdf"},
                                                         {"application/font-tdpfr", "pfr"},
                                                         {"application/pgp-encrypted", "pgp"},
                                                         {"application/octet-stream", "pkg"},
                                                         {"application/pkixcmp", "pki"},
                                                         {"application/pkix-pkipath", "pkipath"},
                                                         {"application/pls+xml", "pls"},
                                                         {"image/png", "png"},
                                                         {"application/pics-rules", "prf"},
                                                         {"application/postscript", "ps"},
                                                         {"application/pskc+xml", "pskcxml"},
                                                         {"video/quicktime", "qt"},
                                                         {"application/raml+yaml", "raml"},
                                                         {"application/rdf+xml", "rdf"},
                                                         {"application/reginfo+xml", "rif"},
                                                         {"application/resource-lists+xml", "rl"},
                                                         {"application/resource-lists-diff+xml", "rld"},
                                                         {"audio/midi", "rmi"},
                                                         {"application/relax-ng-compact-syntax", "rnc"},
                                                         {"application/xml", "rng"},
                                                         {"application/rpki-roa", "roa"},
                                                         {"text/troff", "roff"},
                                                         {"application/sparql-query", "rq"},
                                                         {"application/rls-services+xml", "rs"},
                                                         {"application/rsd+xml", "rsd"},
                                                         {"application/rss+xml", "rss"},
                                                         {"application/rtf", "rtf"},
                                                         {"text/richtext", "rtx"},
                                                         {"audio/s3m", "s3m"},
                                                         {"application/sbml+xml", "sbml"},
                                                         {"application/scvp-cv-request", "scq"},
                                                         {"application/scvp-cv-response", "scs"},
                                                         {"application/sdp", "sdp"},
                                                         {"application/java-serialized-object", "ser"},
                                                         {"application/set-payment-initiation", "setpay"},
                                                         {"application/set-registration-initiation", "setreg"},
                                                         {"image/sgi", "sgi"},
                                                         {"text/sgml", "sgm"},
                                                         {"text/sgml", "sgml"},
                                                         {"text/shex", "shex"},
                                                         {"application/shf+xml", "shf"},
                                                         {"text/html", "shtml"},
                                                         {"application/pgp-signature", "sig"},
                                                         {"audio/silk", "sil"},
                                                         {"model/mesh", "silo"},
                                                         {"text/slim", "slim"},
                                                         {"text/slim", "slm"},
                                                         {"application/smil+xml", "smi"},
                                                         {"application/smil+xml", "smil"},
                                                         {"audio/basic", "snd"},
                                                         {"application/octet-stream", "so"},
                                                         {"application/scvp-vp-response", "spp"},
                                                         {"application/scvp-vp-request", "spq"},
                                                         {"audio/ogg", "spx"},
                                                         {"application/sru+xml", "sru"},
                                                         {"application/sparql-results+xml", "srx"},
                                                         {"application/ssdl+xml", "ssdl"},
                                                         {"application/ssml+xml", "ssml"},
                                                         {"application/hyperstudio", "stk"},
                                                         {"text/stylus", "styl"},
                                                         {"text/stylus", "stylus"},
                                                         {"image/svg+xml", "svg"},
                                                         {"image/svg+xml", "svgz"},
                                                         {"text/troff", "t"},
                                                         {"image/t38", "t38"},
                                                         {"application/tei+xml", "tei"},
                                                         {"application/tei+xml", "teicorpus"},
                                                         {"text/plain", "text"},
                                                         {"application/thraud+xml", "tfi"},
                                                         {"image/tiff-fx", "tfx"},
                                                         {"image/tiff", "tif"},
                                                         {"image/tiff", "tiff"},
                                                         {"text/troff", "tr"},
                                                         {"video/mp2t", "ts"},
                                                         {"application/timestamped-data", "tsd"},
                                                         {"text/tab-separated-values", "tsv"},
                                                         {"font/collection", "ttc"},
                                                         {"font/ttf", "ttf"},
                                                         {"text/turtle", "ttl"},
                                                         {"text/plain", "txt"},
                                                         {"message/global-delivery-status", "u8dsn"},
                                                         {"message/global-headers", "u8hdr"},
                                                         {"message/global-disposition-notification", "u8mdn"},
                                                         {"message/global", "u8msg"},
                                                         {"text/uri-list", "uri"},
                                                         {"text/uri-list", "uris"},
                                                         {"text/uri-list", "urls"},
                                                         {"text/vcard", "vcard"},
                                                         {"model/vrml", "vrml"},
                                                         {"text/vtt", "vtt"},
                                                         {"application/voicexml+xml", "vxml"},
                                                         {"application/java-archive", "war"},
                                                         {"application/wasm", "wasm"},
                                                         {"audio/wav", "wav"},
                                                         {"audio/webm", "weba"},
                                                         {"video/webm", "webm"},
                                                         {"application/manifest+json", "webmanifest"},
                                                         {"image/webp", "webp"},
                                                         {"application/widget", "wgt"},
                                                         {"image/wmf", "wmf"},
                                                         {"font/woff", "woff"},
                                                         {"font/woff2", "woff2"},
                                                         {"model/vrml", "wrl"},
                                                         {"application/wsdl+xml", "wsdl"},
                                                         {"application/wspolicy+xml", "wspolicy"},
                                                         {"model/x3d+xml", "x3d"},
                                                         {"model/x3d+binary", "x3db"},
                                                         {"model/x3d+binary", "x3dbz"},
                                                         {"model/x3d+vrml", "x3dv"},
                                                         {"model/x3d+vrml", "x3dvz"},
                                                         {"model/x3d+xml", "x3dz"},
                                                         {"application/xaml+xml", "xaml"},
                                                         {"application/xcap-diff+xml", "xdf"},
                                                         {"application/dssc+xml", "xdssc"},
                                                         {"application/xenc+xml", "xenc"},
                                                         {"application/patch-ops-error+xml", "xer"},
                                                         {"application/xhtml+xml", "xht"},
                                                         {"application/xhtml+xml", "xhtml"},
                                                         {"application/xv+xml", "xhvml"},
                                                         {"audio/xm", "xm"},
                                                         {"application/xml", "xml"},
                                                         {"application/xop+xml", "xop"},
                                                         {"application/xproc+xml", "xpl"},
                                                         {"application/xml", "xsd"},
                                                         {"application/xml", "xsl"},
                                                         {"application/xslt+xml", "xslt"},
                                                         {"application/xspf+xml", "xspf"},
                                                         {"application/xv+xml", "xvm"},
                                                         {"application/xv+xml", "xvml"},
                                                         {"text/yaml", "yaml"},
                                                         {"application/yang", "yang"},
                                                         {"application/yin+xml", "yin"},
                                                         {"text/yaml", "yml"},
                                                         {"application/zip", "zip"}};
    public:
        ConversionHandler(const Library& inputLib);
        ~ConversionHandler();
    public slots:
        void convert(QString playlistRequested, QString saveLocation, QString relativeStructure);
    signals:
        void emitConversionError(conversionErrors outputError);
};
#endif // CONVERSIONHANDLER_H
